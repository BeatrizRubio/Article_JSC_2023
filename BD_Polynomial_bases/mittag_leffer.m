clear all;

format long
n=5;

for i=1:n
    t(i)=6+i/n;
end

32*x^5+160*x^3+48*x
64*x^6+64*x^4+736*x^2
128*x^7+2240*x^5+6272*x^3+1440*x
256*x^8+7168*x^6+39424*x^4+33792*x^2
512*x^9+21504*x^7+204288*x^5+418816*x^3+80640*x
1024*x^10+61440*x^8+924672*x^6+3676160*x^4+2594304*x^2

A=[1,0,0,0,0;0,2,0,0,0;0,0,4,0,0;0,4,0,8,0;0,0,32,0,16];

M=[1,2*t(1),4*t(1)^2,8*t(1)^3+4*t(1),16*t(1)^4+32*t(1)^2;...
   1,2*t(2),4*t(2)^2,8*t(2)^3+4*t(2),16*t(2)^4+32*t(2)^2;...
   1,2*t(3),4*t(3)^2,8*t(3)^3+4*t(3),16*t(3)^4+32*t(3)^2;...
   1,2*t(4),4*t(4)^2,8*t(4)^3+4*t(4),16*t(4)^4+32*t(4)^2;...
   1,2*t(5),4*t(5)^2,8*t(5)^3+4*t(5),16*t(5)^4+32*t(5)^2];

A=[1,0,0,0,0,0,0,0,0,0;...
    0,2,0,0,0,0,0,0,0,0;...
    0,0,4,0,0,0,0,0,0,0;...
    0,4,0,8,0,0,0,0,0,0;...
    0,0,32,0,16,0,0,0,0,0;...
    0,
    
    
    
    ];

M=[1,2*t(1),4*t(1)^2,8*t(1)^3+4*t(1),16*t(1)^4+32*t(1)^2;...
   1,2*t(2),4*t(2)^2,8*t(2)^3+4*t(2),16*t(2)^4+32*t(2)^2;...
   1,2*t(3),4*t(3)^2,8*t(3)^3+4*t(3),16*t(3)^4+32*t(3)^2;...
   1,2*t(4),4*t(4)^2,8*t(4)^3+4*t(4),16*t(4)^4+32*t(4)^2;...
   1,2*t(5),4*t(5)^2,8*t(5)^3+4*t(5),16*t(5)^4+32*t(5)^2];


BDA=BDA(A,M,t);
 cond(M)    
 
b = [17, -31, 77, -83, 27]

size(M)
size(b)
%b = [17, -31, 77, -83, 27, -11, 96, -57, 70, -64];
% % % 
%b=[17,-31,77,-83,27,-11,96,-57,70,-64,29,-41,46,-16,74];

% % % % b=[17,-31,77,-83,27,-11,96,-57,70,-64,29,-41,46,-16,74,-64,29,-41,46,-16]
% % % % % % %    
SolBDA=transpose(TNSolve(BDA,b))
SolM = M\transpose(b)
 
dlmwrite('systemCollocationMittagB5.csv',SolBDA,'precision','%.45f');
dlmwrite('systemCollocationMittagM5.csv',SolM,'precision','%.45f');
% 
% 
