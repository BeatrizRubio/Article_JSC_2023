clear all;

format long


n=5

for i=1:n
    t(i)= 5+i/n;
end 


for i=1:n
    for j=1:n
    M(i,j)=hermiteH(j-1,t(i));
    end   
end 


% A= [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;...
%    0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,;...
%    -2,0,4,0,0,0,0,0,0,0,0,0,0,0,0;...
%    0,-12,0,8,0,0,0,0,0,0,0,0,0,0,0;...
%    12,0,-48,0,16,0,0,0,0,0,0,0,0,0,0;...
%    0,120,0,-160,0,32,0,0,0,0,0,0,0,0,0;...
%    -120,0,720,0,-480,0,64,0,0,0,0,0,0,0,0;...
%    0,-1680,0,3360,0,-1344,0,128,0,0,0,0,0,0,0;...
% 1680,0,-13440,0,13440,0,-3584,0,256,0,0,0,0,0,0;...
% 0,30240,0,-80640,0,48384,0,-9216,0,512,0,0,0,0,0;...
% -30240,0,302400,0,- 403200,0,161280,0, - 23040,0,1024,0,0,0,0;...
% 0,-665280,0,2217600,0, - 1774080,0, + 506880,0,- 56320,0,2048,0,0,0;
% 665280,0,-7983360,0,13305600,0, - 7096320,0, 1520640,0,- 135168,0,4096,0,0;...
% 0,17297280,0,- 69189120,0,69189120,0,- 26357760,0, 4392960,0,- 319488,0,8192,0;...
% -17297280,0,242161920,0,- 484323840,0,322882560,0,- 92252160,0,12300288,0,- 745472,0,16384];

% A=[1,0,0,0,0,0,0,0,0,0;...
%    0,2,0,0,0,0,0,0,0,0;...
%    -2,0,4,0,0,0,0,0,0,0;...
%    0,-12,0,8,0,0,0,0,0,0;...
%    12,0,-48,0,16,0,0,0,0,0;...
%    0,120,0,-160,0,32,0,0,0,0;...
%    -120,0,720,0,-480,0,64,0,0,0;...
%    0,-1680,0,3360,0,-1344,0,128,0,0;...
% 1680,0,-13440,0,13440,0,-3584,0,256,0;...
% 0,30240,0,-80640,0,48384,0,-9216,0,512];

 
A=[1,0,0,0,0;0,2,0,0,0;-2,0,4,0,0; 0,-12,0,8,0;12,0,-48,0,16]

BDA=BDA(A,t)

cond(M)
 

%Inverse matrix

IB=TNInverseExpand(BDA);
IM=inv(M);
dlmwrite('inverseHermiteB.csv',IB,'precision','%.45f');
dlmwrite('inverseHermiteM.csv',IM,'precision','%.45f');


%function A=TNInverseExpand(B)  
%Computes directly the inverse a square TN matrix whose bidiagonal
% bidiagonal decomposition is stored in B, using the 
% results on the factorization of A and its inverse presented in:
% Ana Marco, Jose-Javier Martinez:  Accurate computations with totally 
% positive Bernstein-Vandermonde matrices.
% Electronic Journal of Linear Algebra, Volume 26 (2013): 357--380.




